```markdown
# インフラ設計書: 架電レコメンドツール

## インフラ構成案比較表

| 構成     | クラウドVM (EC2)    | コンテナ (ECS/EKS)  | サーバーレス (Lambda) | PaaS (Heroku)         | オンプレ               |
|----------|-------------------|---------------------|----------------------|-----------------------|----------------------|
| 初期コスト | 中〜高            | 高                  | 低                   | 低                    | 高                   |
| スケーラビリティ | 高              | 非常に高            | 高                   | 中                    | 低                   |
| 運用コスト | 中                | 高                  | 低（イベント駆動）    | 低                    | 高                   |
| チームスキル適合性 | 既存知識あり   | 若干不足あり         | 未知                 | 部分的に知識あり       | 既存施設下で運用可    |
| 維持管理 | 中                | 複雑な管理が必要     | 簡単（自動）         | 簡単な操作            | 課題が出る可能性あり  |

### 選定：プロトタイプ段階ではPaaS (Heroku)

- **理由**：初期コストと運用コストが低く、短期間でのプロトタイプ開発に向いており、柔軟にスケール可能。

## 推奨構成（プロトタイプ段階）

- **インフラ構成**：Herokuを利用して迅速にデプロイを行う。
- **データベース管理**：Heroku PostgreSQLを使用することで、データベースの運用を最小限に抑える。

## 推奨構成（本番移行後）

- **インフラ構成**：AWSによる構成に移行しスケーリングを担保。その中でEC2でのVM運用に加え、必要に応じてECS（Fargate利用）を検討。
  - **理由**：スケーラビリティの確保とコスト効果バランスを重視。

## データパイプライン設計

- **データ取込方法**：AWS LambdaとEventBridgeを使用し、各種データ（基幹システムCSV、支店Excel、名刺OCR）をS3へ定期的に取り込み、GlueでETL処理を自動化。
- **データスケジューリング**：Glueで定期的なデータ変換を行い、Athenaでクエリ可能にする。

## 運用・監視設計

- **監視ツール**：Amazon CloudWatchのアラーム設定により、インフラ全体の監視を実施。
- **障害時フロー**：
  - アラーム発生時にPagerDutyでオンコール担当者に通知。
  - インシデント管理をJiraで行い、ログの確認と復旧手順の実施。

## 役員報告向けリスクと軽減策

| リスク項目                    | 軽減策         |
|-----------------------------|---------------|
| Herokuのスケーラビリティ課題   | 本番環境移行時にはAWSへ            |
| データ取り込みスケジュールの遅れ | EventBridgeのスケジューリング活用 |
| インフラ運用の複雑化         | リソース利用に関するドキュメント化とオンボーディングガイドの作成 |

- **10日間で実現可能な範囲**：PaaSを活用したプロトタイプの完成。
- **本番向け残課題**：
  - AWSインフラへの移行準備
  - 運用ドキュメントと自動化ツールの整備
```